{% extends "container.html" %}

{% block content %}
    <div class="post-leaderboard">
        {% if post.heroImage_id %}
            <div class="hero-image-display" style="background-image: url( {{ post.get_post_hero_image() }} );">
                {% if post.author == current_user %} 
                <a href="{{ url_for('main.post_edit_hero', post_id=post.id) }}" class="icon-block"><i class="material-icons" style="float:right;padding:10px;color:var(--lipstick)" title="change hero image">photo_camera</i></a>
            {% endif %}
            </div>
        {% endif %}
        <div class="post-title-details">
            <h1>{{ post.title }}</h1>
            <h2 class="byline">by <a href="{{ url_for('main.user', username=post.author.username) }}">{{ post.author.username }}</a></h2> 
           
        </div>
    </div>
 
    
    {% if post.intro %}
    <section class="post-intro">
        <blockquote>{{ post.intro }}</blockquote>
    </section>
    {% endif %}

    {% if post.images.count() > 0 %}
    <section class="post-slideshow" data-component="slideshow">
        
        <div id="prev-slide" aria-label="previous image"><i class="material-icons">navigate_before</i></div>
        <div id="next-slide" aria-label="next image"><i class="material-icons">navigate_next</i></div>
        
            {% for image in post.images %}
            <div class="slideshow-container">
                <div class="slideshow-image">
                    <img src="{{ image.get_postedit_format_photo() }}" class="" />
                </div>
                <div class="slideshow-caption">
                    {% if image.caption %}
                        {{ image.caption }} <span id="slide-number"></span>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        
    </section>
    {% endif %}

    {% if post.author == current_user %} 
        <span class="flag-edit">{{ post.isLive | poststatus }}</span>
        {% if not post.isLive %}
        <i class="material-icons" style="float:right;padding:10px;color:var(--lipstick)" title="Post is draft">sticky_note_2</i></a>
        {% endif %}
        <a href="{{ url_for('main.post_edit', post_id=post.id) }}" class="icon-block"><i class="material-icons" style="float:right;padding:10px;color:var(--lipstick)" title="edit this post">edit</i></a>
    {% endif %}

    <div class="post-content">

    <section class="post-body">
        {% if not current_user.is_anonymous %}
        {% if not post.author == current_user %}
            {% if current_user.get_liked_posts(post) %}
                <a href="{{ url_for('main.unlike', post_id=post.id) }}">Unlike</a>
            {% else %}
                <a href="{{ url_for('main.like', post_id=post.id) }}">Like</a>
            {% endif %}
        {% endif %}
        {% endif %}
        <p>{{ post.body | safe }}</p>
    </section>

    <p><span class="label datetime">Published on {{ post.datePosted | daydateformat }}</span> | <a href="{{ url_for('main.users', liked_post=post.id) }}"><span class="label">Likes:</span> {{ post.number_of_likes() }}</a></p>
    <span class="label">Read more &rarr;</span>
    {% for tag in post.posttags.all() %}
        <span class="splash-tag"><a href="{{ url_for('main.posts', tag=tag.name) }}">{{ tag.name }}</a></span>
    {% endfor %}

   
    {% if not current_user.is_anonymous %}
        <!-- Chat about this -->
    <div id="comments"></div>
    {% endif %}
    
</div>
<script type="text/javascript" src="{{ url_for('static', filename='js/post.js') }}"></script>
{% endblock %}