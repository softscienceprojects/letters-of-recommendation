{% extends "container.html" %}

{% block content %}
    <div class="post-leaderboard">
        {% if post.heroImage_id %}
            <div class="hero-image-display" style="background-image: url( {{ post.get_post_hero_image() }} );">
            </div>
        {% endif %}
        {% if post.author == current_user or current_user.isEditor  %} 
            <a href="{{ url_for('main.post_edit_hero', post_id=post.id) }}" class="icon-block"><i class="material-icons button-circle edit edit-image" title="change hero image">photo_camera</i></a>
        {% endif %}
        <div class="post-title-details">
            <h1>{{ post.title }}</h1>
            <h2 class="byline">by <a href="{{ url_for('main.user', username=post.author.username) }}">{{ post.author.username }}</a></h2> 
           
        </div>
    </div>
 
    
    {% if post.intro %}
    <section class="post-intro">
        <h2 class="syne" style="margin: auto;">{{ post.intro }}</h2>
    </section>
    {% endif %}

    {% if post.images.count() > 0 %}
    <section class="post-slideshow" data-component="slideshow">
        
        <div id="prev-slide" aria-label="previous image"><i class="material-icons">arrow_back</i></div>
        <div id="next-slide" aria-label="next image"><i class="material-icons">arrow_forward</i></div>
        
            {% for image in post.images %}
            <div class="slideshow-container">
                <div class="slideshow-image">
                    <img src="{{ image.get_postedit_format_photo() }}" class="" />
                </div>
                <div class="slideshow-caption">
                    {% if image.caption %}
                        {{ image.caption }} <br />
                        <span class="slide-number"></span>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        
    </section>
    {% endif %}

 

    <div class="post-content">
   {% if post.author == current_user or current_user.isEditor %} 
        {% if not post.isLive %}
        <p class="button-base bg-bone syne" style="color: white; display: inline-block;"><span class="flag-edit">{{ post.isLive | poststatus }}</span></p>
        {% endif %}
        <a href="{{ url_for('main.post_edit', post_id=post.id) }}" class="icon-block"><i class="material-icons button-circle edit" style="float:right;margin:10px;" title="edit this post">edit</i></a>
    {% endif %}
    <section class="post-body">
        <p>{{ post.body | safe }}</p>
    </section>

    <section class="post-footer">
           {% if not current_user.is_anonymous %}
            {% if not post.author == current_user %}
                {% if current_user.get_liked_posts(post) %}
                    <a class="fake-button button-base-rounded bg-bone color-cloud" href="{{ url_for('main.unlike', post_id=post.id) }}">Unlike</a>
                {% else %}
                    <a class="fake-button button-base-rounded bg-clay" href="{{ url_for('main.like', post_id=post.id) }}">Like</a>
                {% endif %}
            {% endif %}
        {% endif %}
        <p><span class="datetime">Published on {{ post.datePosted | daydateformat }}</span> | <a href="{{ url_for('main.users', liked_post=post.id) }}"><span>Likes:</span> {{ post.number_of_likes() }}</a></p>
        <span class="label">Read more &rarr;</span>
        {% for tag in post.posttags.all() %}
            <span class="splash-tag bg-clay"><a href="{{ url_for('main.posts', tag=tag.name) }}">{{ tag.name }}</a></span>
        {% endfor %}
    
        {% if not current_user.is_anonymous %}
            <!-- Chat about this -->
        <div id="comments"></div>
        {% endif %}
    </section>
</div>
<script type="text/javascript" src="{{ url_for('static', filename='js/post.js') }}"></script>
{% endblock %}